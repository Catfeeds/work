(function(b){var a=a||{};a.encrypt=function(h,l){if(l==null||l.length<=0){alert("Please enter a password with which to encrypt the message.");return null}var n="";for(var e=0;e<l.length;e++){n+=l.charCodeAt(e).toString()}var j=Math.floor(n.length/5);var d=parseInt(n.charAt(j)+n.charAt(j*2)+n.charAt(j*3)+n.charAt(j*4)+n.charAt(j*5));var c=Math.ceil(l.length/2);var k=Math.pow(2,31)-1;if(d<2){alert("Algorithm cannot find a suitable hash. Please choose a different password.  Possible considerations are to choose a more complex or longer password.");return null}var f=Math.round(Math.random()*1000000000)%100000000;n+=f;while(n.length>10){n=(parseInt(n.substring(0,10))+parseInt(n.substring(10,n.length))).toString()}n=(d*n+c)%k;var g="";var m="";for(var e=0;e<h.length;e++){g=parseInt(h.charCodeAt(e)^Math.floor((n/k)*255));if(g<16){m+="0"+g.toString(16)}else{m+=g.toString(16)}n=(d*n+c)%k}f=f.toString(16);while(f.length<8){f="0"+f}m+=f;return m};a.decrypt=function(h,l){if(h==null||h.length<8){alert("A salt value could not be extracted from the encrypted message because it's length is too short. The message cannot be decrypted.");return}if(l==null||l.length<=0){alert("Please enter a password with which to decrypt the message.");return}var n="";for(var e=0;e<l.length;e++){n+=l.charCodeAt(e).toString()}var j=Math.floor(n.length/5);var d=parseInt(n.charAt(j)+n.charAt(j*2)+n.charAt(j*3)+n.charAt(j*4)+n.charAt(j*5));var c=Math.round(l.length/2);var k=Math.pow(2,31)-1;var f=parseInt(h.substring(h.length-8,h.length),16);h=h.substring(0,h.length-8);n+=f;while(n.length>10){n=(parseInt(n.substring(0,10))+parseInt(n.substring(10,n.length))).toString()}n=(d*n+c)%k;var g="";var m="";for(var e=0;e<h.length;e+=2){g=parseInt(parseInt(h.substring(e,e+2),16)^Math.floor((n/k)*255));m+=String.fromCharCode(g);n=(d*n+c)%k}return m};b.des=a})(window);