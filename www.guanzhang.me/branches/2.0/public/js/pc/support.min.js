gz=window.gz||{};gz.support={};$(document).ready(function(){$.ajax({type:"get",url:"/newsType/newsType_list.action",data:{type:3,time:new Date().getTime()},async:false,dataType:"json",timeout:6000,success:function(a){if(!a.success){alert(a.errorMsg);return}if(a.data&&a.data.length>0){gz.support.loadType(a.data);var b=$(".support .menu dl:first dd:first a").attr("data-id");if(!b){return}gz.support.getListId=b;gz.support.getList(b,1);$(".support .menu dl:first dt").addClass("cur");$(".support .menu dl:first dd:first").addClass("cur");$("#list .title").html($(".support .menu dl:first dd:first em").html())}},error:function(){console.log("请求失败...")}});$(".support .menu dd").on("click",function(){$(".support .menu dt").removeClass("cur");$(".support .menu dd").removeClass("cur");$(this).addClass("cur").siblings("dt").addClass("cur");$("#list .title").html($("em",this).html())});$("#prevPage").click(function(){if($(this).hasClass("disable")){return}var a=parseInt($("#pageNum").text())-1;gz.support.getList(gz.support.getListId,a)});$("#nextPage").click(function(){if($(this).hasClass("disable")){return}var a=parseInt($("#pageNum").text())+1;gz.support.getList(gz.support.getListId,a)});$("#back").click(function(){$("#list").show();$("#detail").hide();$("#detail .title").empty();$("#detail .detail").empty()})});gz.support.loadType=function(d){var e=[];for(var b=0;b<d.length;b++){var c=[];for(var a=0;a<d[b].list.length;a++){c.push('<dd><a href="#" data-id="'+d[b].list[a].id+'" onclick="gz.support.getList('+d[b].list[a].id+', 1)"><span>－</span><em>'+d[b].list[a].name+"</em></a></dd>")}e.push("<dl><dt>"+d[b].name+"</dt>"+c.join("")+"</dl>")}$(".support .menu").html(e.join(""))};gz.support.getList=function(b,a){$("#list .title").empty();$("#list .list ul").empty();$("#list").show();$("#detail").hide();$("#detail .title").empty();$("#detail .detail").empty();gz.support.getListId=b;$.ajax({type:"get",url:"/news/query_byType.action",async:true,data:{type:b,pageNum:a,pageSize:20,time:new Date().getTime()},dataType:"json",timeout:6000,success:function(g){if(!g.success){alert(g.errorMsg);return}if(!g.data.list||g.data.list.length<1){$("#list .page").hide();return}var h=g.data.pages,f=g.data.pageNum,d=g.data.pageCount;$("#pages").text(h);$("#pageNum").text(f);$("#pageCount").text(d);$("#list .page").show();if(f>1){$("#prevPage").removeClass("disable")}else{$("#prevPage").addClass("disable")}if(f<h){$("#nextPage").removeClass("disable")}else{$("#nextPage").addClass("disable")}if(g.data&&g.data.list&&g.data.list.length>0){var c=[];for(var e=0;e<g.data.list.length;e++){c.push('<li><a href="javascript:;" onclick="gz.support.loadContent('+g.data.list[e].id+')">'+g.data.list[e].title+"</a></li>")}$(".support .c .list ul").html(c.join(""))}},error:function(){console.log("请求失败...")}})};gz.support.loadContent=function(a){$.ajax({type:"get",url:"/news/news_getById.action",data:{id:a,time:new Date().getTime()},async:true,dataType:"json",timeout:6000,success:function(b){if(!b.success){alert(b.errorMsg);return}$("#list").hide();$("#detail").show();$("#detail .title").html(b.data.title);$("#detail .detail").html(b.data.content)},error:function(){console.log("请求失败...")}})};gz.submitForm=function(){var b=$.trim($("#name").val()),f=$.trim($("#userName").val()),c=$.trim($("#tel").val()),a=$.trim($("#province").val()),e=$.trim($("#city").val()),g=$.trim($("#address").val()),d=/^(\+|00)?((86)?(1[34578])[0-9]{9}|852[965][0-9]{7})$/i;if(b.length<1){$(".error").html("请输入场馆名称").fadeIn();return}if(f.length<1){$(".error").html("请输入姓名").fadeIn();return}if(c.length<1){$(".error").html("请输入联系电话").fadeIn();return}if(!d.test(c)){$(".error").html("请输入正确的手机号码").fadeIn();return}if(a.length<1){$(".error").html("请输入所在省份").fadeIn();return}if(e.length<1){$(".error").html("请输入所在城市").fadeIn();return}$.ajax({url:$(".form form").attr("action"),type:"post",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({venue:b,link_men:f,link_phone:c,province:a,city:e,address:g}),success:function(h){if(!h.success){$(".error").html(h.errorMsg).fadeIn();return}$(".error").html("发送成功！").fadeIn()},error:function(){console.log("请求失败...")}})};